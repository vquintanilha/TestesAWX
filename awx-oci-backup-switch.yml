- name: Run backup script
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Ensure script is executable
      ansible.builtin.file:
        path: /runner/project/scripts/manage_backup.sh
        mode: '0755'

    - name: Execute backup script
      ansible.builtin.command:
        cmd: /runner/project/scripts/manage_backup.sh
      environment:
        OCI_USER: "{{ lookup('env','OCI_USER') }}"
        OCI_TENANCY: "{{ lookup('env','OCI_TENANCY') }}"
        OCI_FINGERPRINT: "{{ lookup('env','OCI_FINGERPRINT') }}"
        OCI_REGION: "{{ lookup('env','OCI_REGION') }}"
        OCI_KEY_CONTENT: "{{ lookup('env','OCI_KEY_CONTENT') }}"
